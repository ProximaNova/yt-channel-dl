read -p "playlist id (such as UUKH5pAE4DLpNr2OLaM_lKKA): " playlist; echo $IPFS_PATH; yt-dlp -v 2>&1 | grep version; yt-dlp -j --flat-playlist $playlist > 1plist1.json 2>1error1.log.txt; cat 1plist1.json | jq ".id" | tr -d \" >> 1plist1.txt; fdir=$(yt-dlp --get-filename --skip-download --restrict-filenames --windows-filenames -o "%(channel)s_%(channel_id)s" -- $(head -n1 1plist1.txt)); if [ -f $fdir ]; then sleep 9d; else mkdir $fdir; fi; cd $fdir; mv -n ../1plist1.txt .; mv -n ../1plist1.json .; mv -n ../1error1.log.txt .; utc | tr -d \\n > 1stats1.txt; echo " overall start" >> 1stats1.txt; chan=$(pwd | grep -o "........................$"); bash <(curl -sL https://web.archive.org/web/20240601090036if_/https://gateway.pinata.cloud/ipfs/bafkreiax2gvahqvtx5vbnrnnz62p2robdj5n6zgy3xykwlwdwh4fvqety4 | sed "s/y.com.sb/invidious.protokolla.fi/g"); utc | tr -d \\n >> 1stats1.txt; echo " channel video count, metadata, profile picture, and banner downloaded" >> 1stats1.txt; cat 1plist1.txt | xargs -d "\n" sh -c 'for args do wget --spider --no-verbose "https://tpa.mares.workers.dev/?output=html&id=$args" -o temp.txt; cat temp.txt >> 1plist2.txt; done' _; rm temp.txt; grep -v '!!!\| 200 OK$' 1plist2.txt | sed "s/.*=//g" | sed "s/://g" > 1plist3.txt; ids=1plist3.txt; utc | tr -d \\n >> 1stats1.txt; echo " check other site done" >> 1stats1.txt; bash <(echo -n "ids=1plist3.txt;"; curl -sL https://web.archive.org/web/20240606200627if_/https://gateway.pinata.cloud/ipfs/bafkreidih3jklvypuib2lisvi2du4lodhdjt5ebr36o7v52f6xmegltlty | sed "s/ torsocks / /g"); utc | tr -d \\n >> 1stats1.txt; echo " videos, descriptions, thumbnails, info JSON with comments, and any subtitles downloaded" >> 1stats1.txt; cat $ids | xargs -d "\n" sh -c 'for args do fname=$(yt-dlp --restrict-filenames --windows-filenames --skip-download --get-filename -o "%(title)s-%(channel)s-%(upload_date)s-%(extractor)s-%(resolution)s-%(id)s.apimeta.txt" -- $args 2>>1error1.log.txt); curl -sL "https://www.googleapis.com/youtube/v3/videos?key=$(cat ~/ytapikey1.txt)&part=snippet,id,contentDetails,liveStreamingDetails,localizations,player,recordingDetails,statistics,status,topicDetails&id=$args" > $fname; done' _; utc | tr -d \\n >> 1stats1.txt; echo " video metadata downloaded" >> 1stats1.txt; curl -sL "https://www.googleapis.com/youtube/v3/channelSections?key=$(cat ~/ytapikey1.txt)&part=id,snippet,contentDetails&channelId=$chan" > 1_channel_sections_1.json; curl -sL "https://www.googleapis.com/youtube/v3/playlists?key=$(cat ~/ytapikey1.txt)&part=id,snippet,contentDetails,localizations,player,status&channelId=$chan&maxResults=50" > 1_channel_playlists_1.json; curl -sL "https://www.googleapis.com/youtube/v3/subscriptions?key=$(cat ~/ytapikey1.txt)&part=id,snippet,contentDetails,subscriberSnippet&channelId=$chan&maxResults=50" > 1_channel_subscriptions_1.json; if [ $(cat 1_channel_subscriptions_1.json | jq .pageInfo.totalResults) -gt 50 ]; then nextpagetoken=$(cat 1_channel_subscriptions_1.json | jq -r .nextPageToken); while [ ! "$nextpagetoken" = "null" ]; do echo $nextpagetoken; curl -sL "https://www.googleapis.com/youtube/v3/subscriptions?key=$(cat ~/ytapikey1.txt)&part=id,snippet,contentDetails,subscriberSnippet&channelId=$chan&maxResults=50&pageToken=$nextpagetoken" > temp.txt; cat temp.txt >> 1_channel_subscriptions_all_1.json; nextpagetoken=$(cat temp.txt | jq -r .nextPageToken); done; utc | tr -d \\n >> 1stats1.txt; echo " channel metadata such as playlists and subscriptions downloaded" >> 1stats1.txt; fi; utc | tr -d \\n >> 1stats1.txt; echo " overall done" >> 1stats1.txt; bash <(curl -sL https://web.archive.org/web/20240706195545if_/https://gateway.pinata.cloud/ipfs/bafkreibmctj6wjeajcf2ce36efsatxicjfazuo63fow46wpmk3wstwfcxa); ip6=$(curl -6s https://ipv6.icanhazip.com); sed -i "s/$ip6/0.0.0.0/g" *.info.json; ip6u=$(urlencode "$ip6"); sed -i "s/$ip6u/0.0.0.0/g" *.info.json; cd ..
